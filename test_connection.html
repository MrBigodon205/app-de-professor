<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste de Conexão Supabase</title>
    <style>
        body {
            font-family: sans-serif;
            padding: 20px;
            background: #f0f0f0;
        }

        .box {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            max-width: 500px;
            margin: 0 auto;
        }

        button {
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            background: #2563eb;
            color: white;
            border: none;
            border-radius: 4px;
        }

        button:hover {
            background: #1d4ed8;
        }

        #status {
            margin-top: 20px;
            font-weight: bold;
        }

        .error {
            color: red;
        }

        .success {
            color: green;
        }
    </style>
</head>

<body>
    <div class="box">
        <h2>Teste de Conexão Local</h2>
        <p>Este teste conecta diretamente ao Supabase, fora do app.</p>
        <p>URL: <code>https://znvcxbcuctyeaylttbfr.supabase.co</code></p>
        <button onclick="testConnection()">Testar Agora</button>
        <div id="status">Aguardando...</div>
        <pre id="log"
            style="background: #eee; padding: 10px; margin-top: 10px; font-size: 11px; overflow-x: auto;"></pre>
    </div>

    <script>
        const SUPABASE_URL = 'https://znvcxbcuctyeaylttbfr.supabase.co';
        const API_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InpudmN4YmN1Y3R5ZWF5bHR0YmZyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjYyNzk2ODcsImV4cCI6MjA4MTg1NTY4N30.OtLz1dNQlFRDsS_RuCtCSkhAP6GEkJ0Qy65RZqkOH5k';

        async function testConnection() {
            const status = document.getElementById('status');
            const log = document.getElementById('log');

            status.innerHTML = 'Conectando...';
            status.className = '';
            log.innerText = 'Iniciando fetch...';

            const start = Date.now();

            try {
                // Manual Fetch to simulate Supabase Client
                const response = await fetch(`${SUPABASE_URL}/rest/v1/profiles?select=*&limit=1`, {
                    method: 'GET',
                    headers: {
                        'apikey': API_KEY,
                        'Authorization': `Bearer ${API_KEY}`,
                        'Content-Type': 'application/json'
                    }
                });

                if (response.ok) {
                    const data = await response.json();
                    const time = Date.now() - start;
                    status.innerHTML = `✅ SUCESSO! (${time}ms)`;
                    status.className = 'success';
                    log.innerText += `\nStatus: ${response.status}\nDados recebidos (1 item).`;
                } else {
                    const errText = await response.text();
                    throw new Error(`Erro ${response.status}: ${errText}`);
                }
            } catch (err) {
                status.innerHTML = `❌ FALHA`;
                status.className = 'error';
                log.innerText += `\nErro: ${err.message}`;
            }
        }
    </script>
</body>

</html>